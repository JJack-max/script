## 问题 #246（纠错后）

一家公司在**多个可用区**的 **Amazon EC2 实例**上运行一个 **Web 应用程序**。  
这些 EC2 实例位于**私有子网**中。  

解决方案架构师已部署一个**面向互联网的 Application Load Balancer（ALB）**，并将 EC2 实例指定为其目标组。  
然而，**来自互联网的流量无法到达 EC2 实例**。

解决方案架构师应如何重新配置架构以解决此问题？

A. 用网络负载均衡器（NLB）替换 ALB。在公共子网中配置 NAT 网关以允许互联网流量。  
B. 将 EC2 实例移动到公共子网。添加安全组规则以允许来自 0.0.0.0/0 的出站流量。  
C. 更新 EC2 实例子网的路由表，将 0.0.0.0/0 的流量路由到 Internet Gateway。添加安全组规则允许出站到 0.0.0.0/0。  
D. 在每个可用区创建**公共子网**，将这些公共子网与 **ALB 关联**，并确保 ALB 可以将流量转发到私有子网中的 EC2 实例。

---

## 正确答案
**👉 D**

---

## 解析

### 考点
- **Internet-facing ALB 的部署要求**
- 公共子网 vs 私有子网职责划分
- 正确的 VPC 网络流量路径

---

### 为什么选 D

- **面向互联网的 ALB 必须部署在公共子网**
  - 公共子网需要：
    - 路由表中有 `0.0.0.0/0 → Internet Gateway`
- **后端 EC2 实例可以（且应当）位于私有子网**
- 正确架构是：
```
Internet
↓
Internet-facing ALB（公共子网）
↓
EC2 实例（私有子网）
```

- ALB 通过其安全组将流量转发到私有子网中的目标组实例

👉 这是 AWS 官方推荐的 **标准 Web 架构**

---

### 其他选项为什么错

#### ❌ A. NLB + NAT Gateway
- NAT Gateway 只用于 **私有子网出站访问互联网**
- ❌ 与入站流量问题无关
- NLB 也同样需要放在公共子网

---

#### ❌ B. 将 EC2 实例移到公共子网
- 不必要地暴露实例到公网
- 违反 **最小暴露原则**
- 安全性差

---

#### ❌ C. 私有子网路由到 Internet Gateway
- 私有子网 **不应直接路由到 IGW**
- 这样会把私有子网变成公共子网
- 架构设计错误

---

## 一句话记忆
> **Internet-facing ALB 一定在公共子网，后端实例放私有子网**

考试秒杀版：

> **外网进 ALB → ALB 在公共子网**
