## é—®é¢˜ #327

è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆå¿…é¡»**ä¿æŠ¤æ‰˜ç®¡åœ¨ Amazon EC2 å®ä¾‹ä¸Šçš„ VPC ç½‘ç»œ**ã€‚  
è¿™äº› EC2 å®ä¾‹ï¼š

- è¿è¡Œåœ¨ **ç§æœ‰å­ç½‘**
- åŒ…å« **é«˜åº¦æ•æ„Ÿæ•°æ®**
- æ ¹æ®å…¬å¸å®‰å…¨ç­–ç•¥ï¼š
  - **åªèƒ½**è®¿é—®ç”¨äº**è½¯ä»¶æ›´æ–°çš„ã€å·²æ‰¹å‡†çš„ç¬¬ä¸‰æ–¹ URL**
  - **æ‰€æœ‰å…¶ä»–äº’è”ç½‘æµé‡å¿…é¡»è¢«é˜»æ­¢**

å“ªç§è§£å†³æ–¹æ¡ˆå¯ä»¥æ»¡è¶³è¿™äº›è¦æ±‚ï¼Ÿ

A. æ›´æ–°ç§æœ‰å­ç½‘çš„è·¯ç”±è¡¨ï¼Œå°†å‡ºç«™æµé‡è·¯ç”±åˆ° **AWS Network Firewall**ã€‚é…ç½® **åŸŸååˆ—è¡¨è§„åˆ™ç»„**ã€‚  
B. è®¾ç½® AWS WAF ç½‘ç»œ ACLã€‚åˆ›å»ºä¸€ç»„è‡ªå®šä¹‰è§„åˆ™ï¼Œæ ¹æ®æºå’Œç›®æ ‡ IP åœ°å€èŒƒå›´è¿‡æ»¤æµé‡è¯·æ±‚ã€‚  
C. å®æ–½ä¸¥æ ¼çš„å…¥ç«™å®‰å…¨ç»„è§„åˆ™ã€‚é…ç½®ä¸€ä¸ªå‡ºç«™è§„åˆ™ï¼Œä»…å…è®¸æµé‡åˆ°äº’è”ç½‘ä¸Šæˆæƒçš„è½¯ä»¶åº“ï¼ˆæŒ‡å®š URLï¼‰ã€‚  
D. åœ¨ EC2 å®ä¾‹å‰é…ç½®ä¸€ä¸ªåº”ç”¨ç¨‹åºè´Ÿè½½å‡è¡¡å™¨ï¼ˆALBï¼‰ï¼Œå°†æ‰€æœ‰å‡ºç«™æµé‡å®šå‘åˆ° ALBï¼Œå¹¶åœ¨ç›‘å¬å™¨ä¸­ä½¿ç”¨åŸºäº URL çš„è§„åˆ™ã€‚

---

## æ­£ç¡®ç­”æ¡ˆ
**ğŸ‘‰ A**

---

## è§£æ

### è€ƒç‚¹
- **VPC å‡ºç«™æµé‡æ§åˆ¶ï¼ˆEgress filteringï¼‰**
- **åŸºäºåŸŸåï¼ˆURL/FQDNï¼‰çš„è®¿é—®æ§åˆ¶**
- AWS Network Firewall vs SG / NACL / WAF
- ç§æœ‰å­ç½‘è®¿é—®äº’è”ç½‘çš„å®‰å…¨è®¾è®¡

---

### ä¸ºä»€ä¹ˆé€‰ A

#### âœ… AWS Network Firewall + åŸŸåè§„åˆ™ = å®˜æ–¹è§£æ³•

**æ–¹æ¡ˆ A æ˜¯å”¯ä¸€çœŸæ­£æ”¯æŒâ€œåªå…è®¸è®¿é—®æŒ‡å®š URLï¼Œå…¶ä½™å…¨éƒ¨é˜»æ–­â€çš„æ–¹æ¡ˆã€‚**

---

### 1ï¸âƒ£ Network Firewall æ”¯æŒåŸºäºåŸŸåçš„æ§åˆ¶

- **AWS Network Firewall** æ”¯æŒï¼š
  - Stateful inspection
  - **Domain listï¼ˆFQDNï¼‰è§„åˆ™ç»„**
- å¯ä»¥æ˜ç¡®é…ç½®ï¼š
  - âœ… å…è®¸è®¿é—®çš„ç¬¬ä¸‰æ–¹è½¯ä»¶ä»“åº“åŸŸå
  - âŒ é˜»æ­¢æ‰€æœ‰å…¶ä»–äº’è”ç½‘è®¿é—®

ğŸ‘‰ **ç²¾å‡†ç¬¦åˆé¢˜ç›®ä¸­çš„â€œåªèƒ½è®¿é—®æ‰¹å‡†çš„ç¬¬ä¸‰æ–¹ URLâ€**

---

### 2ï¸âƒ£ é€‚ç”¨äºç§æœ‰å­ç½‘å‡ºç«™æµé‡æ§åˆ¶

- ç§æœ‰å­ç½‘ï¼š
  - è·¯ç”±è¡¨ â†’ æŒ‡å‘ Network Firewall ç«¯ç‚¹
- æ‰€æœ‰å‡ºç«™æµé‡å¿…é¡»ç»è¿‡é˜²ç«å¢™æ£€æŸ¥
- å®ç° **é›†ä¸­ã€å¼ºåˆ¶çš„ç½‘ç»œå±‚ç®¡æ§**

---

### 3ï¸âƒ£ æ»¡è¶³åˆè§„ä¸å®‰å…¨è¦æ±‚

- ç½‘ç»œå±‚å¼ºåˆ¶ç­–ç•¥ï¼ˆæ— æ³•ç»•è¿‡ï¼‰
- å¯å®¡è®¡ã€å¯é›†ä¸­ç®¡ç†
- AWS å®˜æ–¹æ¨èçš„ **VPC çº§é˜²ç«å¢™æ–¹æ¡ˆ**

---

## å…¶ä»–é€‰é¡¹ä¸ºä»€ä¹ˆé”™

### âŒ B. AWS WAF + NACL
- AWS WAFï¼š
  - ä»…ç”¨äº **HTTP/HTTPS å…¥ç«™**
  - ä½œç”¨å¯¹è±¡æ˜¯ **ALB / CloudFront / API Gateway**
- NACLï¼š
  - åªèƒ½åŸºäº **IP / ç«¯å£**
  - âŒ ä¸æ”¯æŒ URL / åŸŸå

---

### âŒ C. å®‰å…¨ç»„å‡ºç«™è§„åˆ™
- å®‰å…¨ç»„ï¼š
  - âŒ ä¸æ”¯æŒ URL / åŸŸå
  - åªèƒ½ä½¿ç”¨ IP åœ°å€
- ç¬¬ä¸‰æ–¹è½¯ä»¶ä»“åº“ IP ç»å¸¸å˜åŒ–
- âŒ ä¸å¯ç»´æŠ¤ã€ä¸ç¬¦åˆé¢˜æ„

---

### âŒ D. ä½¿ç”¨ ALB æ§åˆ¶å‡ºç«™æµé‡
- ALBï¼š
  - è®¾è®¡ç”¨äº **å…¥ç«™æµé‡**
- ä¸èƒ½ä½œä¸ºé€šç”¨çš„å‡ºç«™ä»£ç†
- ä¸æ”¯æŒ VPC å†…æ‰€æœ‰å®ä¾‹çš„ç»Ÿä¸€å‡ºç«™æ§åˆ¶
- âŒ æ¶æ„é”™è¯¯ï¼Œè€ƒè¯•é™·é˜±

---

## ä¸€å¥è¯è®°å¿†
> **â€œç§æœ‰å­ç½‘ + åªå…è®¸è®¿é—®æŒ‡å®š URLâ€ â†’ AWS Network Firewall**

### è€ƒè¯•ç§’æ€ç‰ˆ
> **Egress æ§åˆ¶ + URL ç™½åå• = Network Firewallï¼ˆDomain listï¼‰**
