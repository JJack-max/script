## 问题 #353

一家公司在**单个可用区**的 **Amazon EC2 实例**上托管一个**三层 Web 应用程序**。  
该应用使用一个**自管理的 MySQL 数据库**，数据库运行在 EC2 实例上，并将数据存储在 **Amazon EBS** 卷中。

当前数据库配置：
- 数据库存储：**1 TB io2（预置 IOPS SSD）EBS 卷**
- 峰值负载时 IOPS：**1,000**
- 数据库运行在 **单 AZ**
- 自管理 MySQL

公司计划：
- 在**几乎不中断服务**的情况下迁移
- **IOPS 提升到原来的 2 倍**
- **稳定性能**
- **降低成本**
- 将数据库迁移到一个**高可用、容错、完全托管**的解决方案

哪种解决方案**最具成本效益**地满足这些要求？

A. 使用 **Amazon RDS for MySQL Multi-AZ** 部署，并使用 **io2 Block Express**  
B. 使用 **Amazon RDS for MySQL Multi-AZ** 部署，并使用 **通用型 SSD（gp2）**  
C. 使用 **Amazon S3 智能分层存储**  
D. 使用两个大型 EC2 实例以主动-被动模式托管数据库  

---

## 正确答案
**👉 B**

---

## 解析

### 考点
- **自管数据库 → 托管数据库迁移**
- **RDS Multi-AZ 高可用**
- **IOPS 成本优化**
- io2 vs gp2/gp3 的取舍
- 性能稳定 + 成本控制

---

## 为什么选 B

### ✅ RDS Multi-AZ = 高可用 + 最低运维

- **Amazon RDS for MySQL（Multi-AZ）**
  - 自动主备切换
  - 自动备份
  - 自动修复
  - AWS 托管
- 满足：
  - 高可用
  - 容错
  - 几乎无中断迁移（可使用 RDS Blue/Green 或 DMS）

---

### 1️⃣ IOPS 要求完全满足

- 当前需求：**2,000 IOPS**
- gp2 特性：
  - IOPS = `3 × 容量(GB)`
  - 1 TB = **3,000 IOPS**
- **无需额外付费即可满足性能需求**

👉 性能充足、稳定

---

### 2️⃣ 成本显著低于 io2

| 存储类型 | 成本 | IOPS |
|--------|------|------|
| io2 | 非常高 | 需单独付费 |
| gp2 | **低** | 随容量提供 |

- io2 / io2 Block Express：  
  - 面向 **极高 IOPS（数万级）**
  - 成本远高于需求
- gp2 对 2,000 IOPS 来说 **性价比最优**

---

### 3️⃣ 完全托管，运维成本最低

- 不再需要：
  - OS 维护
  - MySQL 手动备份
  - 故障切换脚本
- AWS 全托管

---

## 其他选项为什么错

### ❌ A. RDS + io2 Block Express
- io2 Block Express：
  - 面向 **超高 IOPS / 超低延迟**
- 当前只需 2,000 IOPS
- **严重过度设计**
- ❌ 成本不合理

---

### ❌ C. Amazon S3 智能分层
- S3：
  - 对象存储
- ❌ 不能作为 MySQL 数据库存储
- ❌ 不支持随机读写

---

### ❌ D. EC2 主备数据库
- 仍然是：
  - 自管理数据库
  - 自己做 HA
  - 自己维护复制
- 运维成本高
- ❌ 不符合“完全托管”

---

## 一句话记忆
> **中等 IOPS + 成本敏感 + 高可用数据库 = RDS Multi-AZ + gp2**

### 考试秒杀版
> **IOPS 不高（几千级） → 优先 gp2/gp3，不要上 io2**
