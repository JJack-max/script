## 问题 #363

一家公司正在构建一个**游戏系统**，需要将**独特事件**同时发送到以下**多个独立服务**：

- 排行榜服务  
- 匹配服务  
- 验证（审计）服务  

系统要求：
- **事件驱动架构**
- **同一事件需要同时发送给多个服务（扇出）**
- **必须保证事件的顺序**

哪种解决方案可以满足这些要求？

A. Amazon EventBridge 事件总线  
B. Amazon Simple Notification Service (Amazon SNS) **FIFO 主题**  
C. Amazon Simple Notification Service (Amazon SNS) 标准主题  
D. Amazon Simple Queue Service (Amazon SQS) FIFO 队列  

---

## 正确答案
**👉 B**

---

## 解析

### 考点
- **事件驱动架构**
- **消息顺序保证**
- **一对多（Fan-out）事件分发**
- SNS vs SQS vs EventBridge 对比

---

## 为什么选 B

### ✅ SNS FIFO 主题 = 有序的事件扇出

**SNS FIFO 主题是唯一同时满足以下三点的服务：**

1. **事件驱动**
2. **支持一对多（多个订阅者）**
3. **保证消息顺序（FIFO）**

---

### 1️⃣ 一条事件 → 多个服务（Fan-out）

- SNS 天生支持：
  - 一个主题
  - 多个订阅者
- 排行榜 / 匹配 / 验证服务：
  - 都可以独立订阅同一个主题
  - 互不影响

👉 完美匹配“同时发送到多个独立服务”

---

### 2️⃣ FIFO 主题保证事件顺序

- SNS FIFO 主题特性：
  - **严格顺序**
  - 去重（Exactly-once）
- 非常适合：
  - 游戏事件
  - 状态变更
  - 分数结算

---

### 3️⃣ 低运维、云原生

- 无需自己维护消息顺序逻辑
- 无需额外协调服务
- 直接使用托管服务

---

## 其他选项为什么错

### ❌ A. EventBridge 事件总线
- EventBridge：
  - **不保证事件顺序**
- 适合松耦合事件路由
- ❌ 不满足“保证顺序”的硬性要求

---

### ❌ C. SNS 标准主题
- SNS 标准主题：
  - **至少一次投递**
  - **不保证顺序**
- ❌ 这是经典陷阱

---

### ❌ D. SQS FIFO 队列
- SQS FIFO：
  - ✅ 保证顺序
  - ❌ 只能被一个消费者组处理
- 不支持天然的 **一对多 Fan-out**
- 若要多个服务：
  - 需要复制队列
  - 架构复杂
- ❌ 不符合题意

---

## 一句话记忆
> **要“有序 + 扇出” → SNS FIFO 主题**

### 考试秒杀版
> **多个系统同时接收同一事件，还要保证顺序：别想 SQS，直接 SNS FIFO**
