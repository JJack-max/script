## 问题 #322

一位解决方案架构师正在为一家公司设计一个**多组件应用程序**。  
应用程序的用户通过**移动设备上传图像**。

应用程序需要完成以下流程：

- 用户上传图像
- 后端**生成缩略图**
- 向用户返回一条消息，确认图像**已成功接收**
- 缩略图生成过程**最长可能需要 60 秒**
- 公司希望：
  - **更快地向用户反馈**（不要等 60 秒）
  - 使用**异步方式**在不同应用组件之间解耦处理

解决方案架构师应该如何设计来满足这些要求？

A. 编写一个自定义 AWS Lambda 函数来生成缩略图并提醒用户。使用图像上传过程作为事件源来调用 Lambda 函数。  
B. 创建一个 AWS Step Functions 工作流，负责编排应用程序层，并在缩略图生成完成时提醒用户。  
C. 创建一个 Amazon Simple Queue Service (Amazon SQS) 消息队列。图像上传时向 SQS 发送消息以触发缩略图生成，并立即向用户发送“已接收”通知。  
D. 创建 Amazon Simple Notification Service (Amazon SNS) 主题和订阅。一个订阅用于生成缩略图，另一个订阅在缩略图生成完成后向移动应用发送推送通知。

---

## 正确答案
**👉 C**

---

## 解析

### 考点
- **异步解耦**
- **快速用户响应**
- **后台长时间处理**
- SQS vs SNS vs Step Functions 的使用场景

---

### 为什么选 C

#### ✅ Amazon SQS = 异步解耦 + 快速响应

方案 C **精准命中题目所有关键词**：

#### 1️⃣ 快速响应用户
- 图像上传后：
  - 应用**立刻返回“已接收”消息**
  - 不等待缩略图生成完成
- 用户体验显著提升

👉 满足题目中  
> “提供更快的响应时间，以通知用户图像已接收”

---

#### 2️⃣ 后台异步处理
- 图像上传后：
  - 向 **SQS 队列发送消息**
- 后端消费者：
  - 从 SQS 拉取消息
  - 生成缩略图（即使耗时 60 秒也没问题）

👉 **前台与后台完全解耦**

---

#### 3️⃣ 架构简单、可扩展
- SQS：
  - 高可靠
  - 自动扩展
  - 支持失败重试
- 非阻塞架构，符合云原生设计

---

### 其他选项为什么错

#### ❌ A. Lambda 同步触发
- Lambda 被直接触发执行缩略图生成
- 若执行时间接近 60 秒：
  - 用户响应会被阻塞
- ❌ 不符合“快速通知用户”的要求

---

#### ❌ B. Step Functions
- Step Functions 适合：
  - 复杂多步骤编排
- 本题只需要：
  - 接收 → 异步处理
- ❌ 架构过重，成本与复杂度过高

---

#### ❌ D. SNS
- SNS 是：
  - **发布 / 订阅**
  - 广播型通知
- 不适合：
  - 控制任务消费
  - 处理长时间任务
- ❌ 不能保证可靠的任务处理与重试

---

## 一句话记忆
> **“用户要立刻收到确认，后台慢慢处理” → SQS**

考试秒杀版：

> **异步处理 + 解耦 + 快速响应 = SQS**
