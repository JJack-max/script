## 问题 #275

一家公司运行一个**内部基于浏览器的应用程序**。  
应用运行在 **Amazon EC2 实例** 上，位于 **Application Load Balancer（ALB）** 之后。  
这些实例运行在**跨多个可用区的 Auto Scaling 组**中。

现状：
- 工作时间扩展到 **20 个实例**
- 夜间缩减到 **2 个实例**
- 员工抱怨：**每天一开始应用很慢**
- 上午中期运行良好

目标：
- 解决员工的性能抱怨
- **同时尽量降低成本**

哪种扩展方式最合适？

A. 使用**计划操作**，在办公室开门前不久将**期望容量**设置为 20  
B. 使用**步进扩展**，设置较低 CPU 阈值并减少冷却时间  
C. 使用**目标跟踪扩展**，设置较低 CPU 阈值并减少冷却时间  
D. 使用**计划操作**，在办公室开门前不久将**最小和最大容量**都设置为 20  

---

## 正确答案
**👉 A**

---

## 解析

### 核心问题本质
- 应用 **每天一开始慢**
- 原因不是扩展策略“不聪明”，而是：
  > **实例启动 + 预热（boot + app warm-up）太慢**
- 员工刚上班时：
  - ASG 还在从 2 个实例慢慢扩到 20 个
  - 用户已经在访问 → 体验差

---

### 为什么选 A（计划扩展 + 期望容量）

#### 计划扩展（Scheduled Scaling）
- **提前**在上班前扩容
- 避免“用户先来，实例后到”的问题
- 非常适合：
  - 访问模式**可预测**
  - 明确的“上班时间 / 下班时间”

#### 设置 *Desired Capacity = 20*
- 上班时立即具备完整算力
- 下班后仍可自动缩回 2 台
- **性能提升 + 不增加额外成本**

✅ 完美解决：
- 早上慢的问题
- 成本控制

---

### 其他选项为什么不对

#### ❌ B. 步进扩展（Step Scaling）
- 仍然是 **被动触发**
- CPU 先升高 → 再扩容
- 用户已经感知到慢了才扩
- ❌ 无法解决“每天一开始慢”的问题

---

#### ❌ C. 目标跟踪扩展（Target Tracking）
- 同样是 **反应式**
- 适合流量不可预测的场景
- 但这里的流量：
  - **高度规律**
  - 每天固定时间开始
- ❌ 不如计划扩展精准

---

#### ❌ D. 设置最小和最大容量都为 20
- 等于 **全天 20 台实例**
- 夜间无法缩容
- ❌ 成本明显上升
- 违背“将成本降到最低”的要求

---

## 考试秒记口诀

> **访问时间可预测 + 早上慢 → Scheduled Scaling**

进一步细分：

> **只要白天高、夜里低 → 计划扩展改 Desired Capacity**

---

## 结论一句话

> **提前扩，而不是等用户来了再扩 —— 计划扩展才是最优解**
